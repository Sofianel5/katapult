{% extends 'main/layout.html' %}
{% load static %}
{% block title %}Reserve Ad Space{% endblock %}
{% block head %}
<!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<!-- Google Fonts -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
<!-- Bootstrap core CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
<!-- Material Design Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.18.0/css/mdb.min.css" rel="stylesheet">
<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->

{% endblock %}
{% block main %}
<div class="reserve-page-holder">
    <div class="full-width start-row-flex">
        <div class="carousel-title">
        Reserve {{ adspace.title }}
        </div>
    </div>
    <div class="center-row-flex">
        <div id="calendar"></div>
    </div>
    <div class="space-evenly-row-flex">
        <div class="container center-row-flex">
            <div class="row">
                <div class='col-sm-6'>
                    <div class="form-group">
                        <div class='input-group date' id='datetimepicker1'>
                            <input type='text' name="start" class="form-control" />
                            <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </span>
                        </div>
                    </div>
                </div>
                <script type="text/javascript">
                    $(function () {
                        $('#datetimepicker1').datetimepicker();
                    });
                </script>
            </div>
        </div>
        <div class="container center-row-flex">
            <div class="row">
                <div class='col-sm-6'>
                    <div class="form-group">
                        <div class='input-group date' id='datetimepicker2'>
                            <input type='text' name="stop" class="form-control" />
                            <span class="input-group-addon">
                                <span class="glyphicon glyphicon-calendar"></span>
                            </span>
                        </div>
                    </div>
                </div>
                <script type="text/javascript">
                    $(function () {
                        $('#datetimepicker2').datetimepicker();
                    });
                </script>
            </div>
        </div>
    </div>
    <div class="center-row-flex full-width">
        <a href="{% url 'success' %}" class="cart-btn">Reserve</a>
    </div>
    <div style="width: 30vw; height: 100vh">
        <div style="position: fixed; width: 30vw; height: 80vh; bottom: 20;right: 20;">
            <div class="mapholder" id="map" style="width: 30vw; height: 80vh;">

            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block bottomScripts %}
<script src="https://cdn.jsdelivr.net/momentjs/2.14.1/moment.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<script>
$('#calendar').fullCalendar({
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'month,agendaWeek,agendaDay,listWeek'
    },
    defaultDate: '2018-11-16',
    navLinks: true,
    eventLimit: true,
    events: [
    {% for reservation in adspace.campaigns.all%}
        {
            title: 'Unavailable',
            start: '{{ reservation.start|date:"Y-m-d" }}',
            end: '{{ reservation.end|date:"Y-m-d" }}'
        },
    {% endfor %}
    ]
});
</script>
<script>
    var regIcon;
    var largeIcon;
    var markers = {};
    function initMap() {
        center = {{ coordinates.0.coordinates |safe }}
        map = new google.maps.Map(document.getElementById('map'), {
        center: center,
        zoom: 10
        });
        regIcon = {
            url: "https://maps.google.com/mapfiles/ms/micons/blue.png",
            scaledSize: new google.maps.Size(32, 32)
        };
        largeIcon = {
            url: "https://maps.google.com/mapfiles/ms/micons/blue.png",
            scaledSize: new google.maps.Size(48, 48)
        };
        {% for coordinate in coordinates %}
        var marker = new google.maps.Marker({
            position: {{ coordinate.coordinates | safe |escape }},
            map: map,
            icon: regIcon,
        });
        markers['{{ coordinate.match }}'] = marker
        {% endfor %}
    }
    function highlightMarker(id) {
        console.log("highlighting " +id)
        marker = markers[id]
        marker.setIcon(largeIcon)
    }
    function unhighlightMarker(id) {
        console.log("unhighlighting "+id)
        marker = markers[id]
        marker.setIcon(regIcon)
    }
</script>
<script defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDWPqLxyV5wfu5STwy70HY0Dx9cL4KXV7I&callback=initMap">
</script>
{% endblock %}
